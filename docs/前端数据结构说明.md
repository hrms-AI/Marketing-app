# 前端数据结构说明文档

## 1. 营销任务数据结构

### 1.1 单个营销任务 (Task)
```typescript
interface MarketingTask {
  id?: string;                    // 任务ID (后端生成)
  time: string;                   // 执行时间，格式：'09:00'
  icon: string;                   // 任务图标 emoji
  title: string;                  // 任务标题
  description: string;            // 任务描述
  status: TaskStatus;             // 任务状态
  statusClass: TaskStatusClass;   // 状态样式类名
  channels: string[];             // 渠道列表
  priority?: 'low' | 'medium' | 'high';  // 优先级
  assignedTo?: string;            // 负责人
  estimatedTime?: number;         // 预计耗时(分钟)
  actualTime?: number;            // 实际耗时(分钟)
  completedAt?: string;           // 完成时间 ISO格式
  notes?: string;                 // 备注说明
}

type TaskStatus = '已完成' | '进行中' | '待执行' | '待审核';
type TaskStatusClass = 'completed' | 'in-progress' | 'pending';
```

### 1.2 每日计划 (DailyPlan)
```typescript
interface DailyPlan {
  day: string;                    // 日期，格式：'01', '02'等
  date?: string;                  // 完整日期：'2025-12-01'
  weekday: string;                // 星期：'周一', '周二'等
  tasks: MarketingTask[];         // 当日任务列表
  taskCount?: number;             // 任务总数
  completionRate?: number;        // 完成率百分比
}
```

### 1.3 营销计划数据 (PlanData)
```typescript
interface PlanData {
  totalTasks: number;             // 总任务数
  completedTasks: number;         // 已完成任务数
  inProgressTasks: number;        // 进行中任务数
  pendingTasks: number;           // 待处理任务数
  dailyPlans: DailyPlan[];        // 每日计划列表
  metrics: PerformanceMetric[];   // 关键指标
}
```

## 2. 性能指标数据结构

### 2.1 单个指标 (PerformanceMetric)
```typescript
interface PerformanceMetric {
  icon: string;                   // 指标图标 emoji
  name: string;                   // 指标名称
  current: string;                // 当前值(字符串格式，可包含单位)
  target: string;                 // 目标值
  progress: number;               // 进度百分比 0-100
  unit?: string;                  // 单位
  trend?: 'up' | 'down' | 'stable'; // 趋势
}
```

### 2.2 渠道统计数据
```typescript
interface ChannelStats {
  channelId: string;              // 渠道ID
  channelName: string;            // 渠道名称
  taskCount: number;              // 任务总数
  completedCount: number;         // 已完成数
  completionRate: number;         // 完成率
  metrics: {
    reach: number;                // 触达量
    engagement: number;           // 互动量
    conversion: number;           // 转化量
    cost: number;                 // 成本
    roi: number;                  // ROI
  };
  trending: 'up' | 'down' | 'stable';
}
```

## 3. 日历相关数据结构

### 3.1 日历日期项
```typescript
interface CalendarDay {
  day: number;                    // 日期数字 1-31
  date: string;                   // 完整日期 '2025-12-01'
  isToday: boolean;               // 是否今天
  isCurrentMonth: boolean;        // 是否当前月
  hasTask: boolean;               // 是否有任务
  taskCount: number;              // 任务数量
  statusIndicator?: 'high' | 'medium' | 'low'; // 任务密度指示
  price?: number;                 // 房价
  occ?: number;                   // 入住率
  otb?: number;                   // 在途预订
}
```

### 3.2 日历数据
```typescript
interface CalendarData {
  year: number;                   // 年份
  month: number;                  // 月份
  weeks: CalendarDay[][];         // 周数据，每周7天
  summary: {
    totalDays: number;            // 总天数
    taskDays: number;             // 有任务的天数
    completionRate: number;       // 整月完成率
  };
}
```

## 4. 用户和酒店数据结构

### 4.1 用户信息
```typescript
interface UserInfo {
  id: string;                     // 用户ID
  username: string;               // 用户名
  nickname: string;               // 昵称
  email: string;                  // 邮箱
  phone: string;                  // 手机号
  role: 'admin' | 'manager' | 'staff'; // 角色
  token: string;                  // 访问令牌
  refreshToken?: string;          // 刷新令牌
  avatar?: string;                // 头像URL
  department?: string;            // 部门
  lastLoginAt?: string;           // 最后登录时间
}
```

### 4.2 酒店信息
```typescript
interface HotelInfo {
  hotelId: string;                // 酒店ID
  hotelName: string;              // 酒店名称
  region: string;                 // 所在区域
  address: string;                // 详细地址
  contact: {
    phone: string;                // 联系电话
    email: string;                // 邮箱
    website?: string;             // 官网
  };
  status: 'active' | 'inactive';  // 状态
  settings?: {
    timezone: string;             // 时区
    currency: string;             // 货币
    language: string;             // 语言
  };
}
```

## 5. 表单和模态框数据结构

### 5.1 新任务表单
```typescript
interface NewTaskForm {
  typeIndex: number;              // 任务类型索引
  title: string;                  // 任务标题
  description: string;            // 任务描述
  type: string;                   // 任务类型
  date: string;                   // 执行日期
  time?: string;                  // 执行时间
  priority?: 'low' | 'medium' | 'high'; // 优先级
  channels?: string[];            // 渠道选择
  assignedTo?: string;            // 指派给
  estimatedTime?: number;         // 预计时间
}
```

### 5.2 活动策划数据
```typescript
interface ActivityPlan {
  theme: string;                  // 活动主题
  target: string;                 // 目标群体
  activities: string;             // 活动内容
  budget: string;                 // 预算范围
  expectedEffect: string;         // 预期效果
  startDate?: string;             // 开始日期
  endDate?: string;               // 结束日期
  channels?: string[];            // 推广渠道
}
```

### 5.3 营销详情数据
```typescript
interface MarketingDetail {
  date: string;                   // 日期
  price: number;                  // 房价
  occupancy: number;              // 入住率
  otb: number;                    // 在途预订
  channels: string[];             // 渠道列表
  content: string[];              // 内容列表
  feedback: TaskFeedback[];       // 反馈列表
}

interface TaskFeedback {
  userId: string;                 // 用户ID
  userName: string;               // 用户名
  comment: string;                // 评论内容
  rating: number;                 // 评分 1-5
  createdAt: string;              // 创建时间
}
```

## 6. 组件Props数据结构

### 6.1 营销日历组件Props
```typescript
interface MarketingCalendarProps {
  hotelId: string;                // 酒店ID
  year: number;                   // 年份
  month: number;                  // 月份
  selectedDate?: string;          // 选中日期
  taskData?: DailyPlan[];         // 任务数据
}
```

### 6.2 任务详情模态框Props
```typescript
interface TaskDetailModalProps {
  visible: boolean;               // 显示状态
  task: MarketingTask | null;     // 任务对象
  readonly?: boolean;             // 只读模式
}
```

### 6.3 底部导航Props
```typescript
interface BottomTabbarProps {
  currentTab: 'strategy' | 'team' | 'material' | 'report'; // 当前选中
  badgeCount?: {                  // 角标数量
    strategy?: number;
    team?: number;
    material?: number;
    report?: number;
  };
}
```

## 7. 状态管理数据结构

### 7.1 全局状态
```typescript
interface AppState {
  user: UserInfo | null;          // 用户信息
  hotel: HotelInfo | null;        // 酒店信息
  currentDate: {
    year: number;
    month: number;
    day: number;
  };
  loading: boolean;               // 全局加载状态
  networkStatus: 'online' | 'offline'; // 网络状态
}
```

### 7.2 营销模块状态
```typescript
interface MarketingState {
  planData: PlanData | null;      // 计划数据
  selectedFilter: 'all' | 'completed' | 'pending' | 'inProgress'; // 筛选状态
  calendarData: CalendarData | null; // 日历数据
  statistics: {
    overview: any;                // 概览统计
    channels: ChannelStats[];     // 渠道统计
  };
}
```

## 8. API请求响应数据结构

### 8.1 通用响应结构
```typescript
interface ApiResponse<T = any> {
  code: number;                   // 状态码
  success: boolean;               // 成功标识
  message: string;                // 消息说明
  data?: T;                       // 数据内容
  errors?: ApiError[];            // 错误详情
  timestamp: string;              // 时间戳
}

interface ApiError {
  field: string;                  // 错误字段
  message: string;                // 错误消息
  code?: string;                  // 错误码
}
```

### 8.2 分页响应结构
```typescript
interface PaginatedResponse<T> {
  items: T[];                     // 数据列表
  pagination: {
    page: number;                 // 当前页
    pageSize: number;             // 每页大小
    total: number;                // 总数
    totalPages: number;           // 总页数
    hasNext: boolean;             // 是否有下页
    hasPrev: boolean;             // 是否有上页
  };
}
```

## 9. 事件回调数据结构

### 9.1 日历事件
```typescript
interface DateClickEvent {
  year: number;
  month: number;
  day: number;
  date: string;                   // 'YYYY-MM-DD'
  hasTask: boolean;
  taskCount: number;
}

interface TaskClickEvent {
  task: MarketingTask;
  date: string;
  source: 'calendar' | 'list';    // 点击来源
}
```

### 9.2 表单事件
```typescript
interface FormSubmitEvent<T = any> {
  formData: T;
  isValid: boolean;
  errors?: Record<string, string>;
}

interface TabChangeEvent {
  current: string;                // 当前tab
  previous: string;               // 上一个tab
}
```

## 10. 本地存储数据结构

### 10.1 缓存键名常量
```typescript
const STORAGE_KEYS = {
  TOKEN: 'token',
  USER_INFO: 'userInfo',
  HOTEL_INFO: 'hotelInfo',
  APP_CONFIG: 'appConfig',
  THEME: 'theme',
  CALENDAR_CACHE: 'calendarCache',
  TASK_CACHE: 'taskCache'
} as const;
```

### 10.2 缓存数据结构
```typescript
interface CacheData {
  data: any;                      // 缓存的数据
  timestamp: number;              // 缓存时间戳
  expiry: number;                 // 过期时间戳
}
```

---

以上数据结构说明涵盖了营销管理系统中使用的主要数据类型，可用于前端开发参考和后端接口对接。
