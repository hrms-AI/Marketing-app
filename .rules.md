
# uiapp 项目全局规则文件

## 指导原则
1. **清晰性优于简洁性**：变量、组件、函数命名需表达真实业务含义，避免 data、temp 等无意义命名。
2. **保持一致性**：全局遵循统一命名、结构、交互和视觉规范。
3. **使用有意义的名称**：所有命名必须能表达实际业务含义。

## 1. 设计原则（uiapp 专用）
1. **单一职责原则**：每个组件/函数/服务只做一件事，UI 组件只负责渲染和交互，业务逻辑全部抽离。
2. **高内聚低耦合**：组件、hooks、服务层职责分明，禁止跨层调用。
3. **可维护性优先**：所有配置、常量、token、类型、接口、工具函数均集中管理，禁止魔法字符串和硬编码。
4. **UI 体验优先**：遵循玻璃拟态、无滚动条、亮色高级感、tailwindcss 视觉规范。
5. **DRY 原则**：重复逻辑必须抽离为共享函数。
6. **开闭原则**：通过扩展而非修改实现新功能。
7. **禁止超大组件/模块**：单文件不超过 400 行。

## 2. 组件和状态三层结构
### 2.1 UI 层（components/）
- 只负责渲染和用户交互，禁止包含任何业务逻辑。
- 组件 props 不超过 7 个，超限需重构为复合组件。
- 组件命名、文件夹、文件均用 kebab-case，主文件为 index.vue/tsx。

### 2.2 逻辑层（hooks/ | composables/ | services/）
- 局部状态：用自定义 Hook/Composable 封装与 UI 强相关的逻辑。
- 全局共享状态：仅限跨组件共享数据（如用户、主题等），用专用 store（如 pinia/zustand）。
- 逻辑层禁止直接操作 UI，仅暴露数据和方法。

### 2.3 服务层（services/）
- 纯业务逻辑和数据处理，必须为无状态函数。
- 接口、类型、常量、工具函数全部集中管理，禁止在 UI/逻辑层出现。

## 3. 状态管理黄金规则
| 状态类型       | 存储位置                | 判断标准                     | 示例                |
|----------------|------------------------|----------------------------|---------------------|
| **父子组件状态** | 组件内    | 仅影响单个组件/父子组件        | 表单输入、模态框开关 |
| **局部状态** | 最近公共父组件/Provider/context | 兄弟组件共享但无需全局访问     | 多选项卡状态         |
| **共享状态** | 自定义 Hook/Composable    | 被 3 个或 3 个以上无关组件使用         | 统计数据、主题色 |
| **全局状态** | 状态管理库（pinia/zustand 等） | 被多个页面、模块使用的; | 用户认证、主题配置   |

## 4. 防劣化措施
- 全局状态库体积警告：store 超过 5 个核心模块必须拆分为独立 slice
- 组件 props 超 7 个参数需重构
- 工具函数全部放 utils/ 目录
- 禁止 any，类型必须强类型，类型定义集中管理
- 禁止硬编码颜色，全部用 token 变量，token 不足需先定义
- 禁止 UI 组件内出现业务逻辑和数据处理

## 5. 重构友好性
- 所有自定义 Hook/Composable 添加 `/* #region 功能描述 */` 注释块
- 复杂逻辑前添加 `// [维护提示]` 注释
- 表格、表单等配置项全部拆分为独立文件
- 类型、接口、常量、token、配置全部集中管理，便于统一修改

## 6. 全局规则文件
- 本文件为 uiapp 项目根目录全局规则文件，所有生成/修改/创建文件均需查找最近的 .rules.md 并严格遵循

## 7. 规则优先级
- 每次提问/生成/修改，先查找目标文件最近的 .rules.md 文件
- 查找顺序：当前目录 > 父级目录 > 根目录
- 若无 .rules.md，默认用根目录 .rules.md

## 8. AI 强制执行规则
### 🚨 重要：AI 执行前必须步骤
1. 查找规则文件：根据目标文件路径，从该目录开始向上查找最近的 .rules.md 文件
2. 读取规则内容：完整读取找到的 .rules.md 文件内容
3. 严格遵循规则：按照规则要求生成内容，不得违反任何规定
4. 如果找不到规则：使用根目录的 .rules.md 作为默认规则

### 🔍 规则查找算法
```
目标文件：src/common/components/Select/index.tsx
查找顺序：
1. src/common/components/.rules.md
2. src/common/.rules.md  ← 找到则使用此规则
3. src/.rules.md
4. ./.rules.md (根目录)
```

### 📝 AI 行为要求
- 生成代码前：必须先执行规则查找和读取
- 遵循规范：严格按照找到的规则生成代码
- 明确说明：告知用户使用了哪个规则文件
- 错误处理：如果规则冲突或不清楚，向用户确认

GoodCase

- 优先使用 uni-app 内置组件（如 <view> <text>），避免直接使用 HTML 标签（如 <div>），防止跨端兼容性问题。
-自定义组件放在 components 目录，通过 easycom 自动引入（无需手动注册），组件 props 需定义类型和默认值，确保传参规范。
-页面生命周期优先使用 onLoad（初始化）、onShow（页面显示），避免依赖 created mounted（跨端表现不一致
-页面跳转用 uni.navigateTo 时，传递参数不超过 1024KB，复杂数据通过 Vuex 或全局事件总线传递。  
-企业微信小程序包体积控制在 2MB 以内（主包），非首屏功能用分包加载（subPackages 配置），避免审核失败。      
请确认你已理解并准备好以 "Archie" 的身份开始工作。